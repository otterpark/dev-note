# Axios vs Fetch

개인적인 생각은 남들이 다 쓰니까 라이브러리를 사용해야 한다보다 왜 사람들이 이 라이브러리를 선호하는지에 대해 알아야한다.

`Fetch`와 `Axios` 중 `Axios`를 왜 더 선호하는지에 대해 알아보자.

## 1. 데이터 JSON 변환

데이터를 전송하기 위해 `Fetch`는 post 요청의 body 속성을 사용하여 엔드포인트로 전송하는 반면, Axios는 데이터 속성을 사용한다. `Fetch`는 body 속성을 통해 보낼 때마다 `JSON.stringify`를 사용해서 보내야하지만 `Axios`에서는 자동으로 처리해준다.

`Axios`는 마찬가지로 response 값을 받을 때 데이터를 자동으로 JSON으로 변환 시켜주기 때문에 따로 값을 보낼 때나 받을 때 JSON을 변환해줄 필요가 없습니다. 하지만 `Fetch`는 JSON 변환이 필요하다.

## 2. 브라우저 호환성

지금은 예전보다는 신경쓰지 않아도 되지만 그래도 항상 문제가 되던 브라우저 호환성에 `Axios`는 매우 강력합니다. 내부적으로 `XMLHttpRequest`를 사용하기 떄문에 브라우저 호환성이 매우 좋습니다.

`Fetch`는 최근 브라우저에서만 사용이 가능하므로 `polyfil(whatwg-fetch)`을 사용하여 지원하지 않는 웹 브라우저에서 사용가능하게 해야합니다.

```js
import 'whatwg-fetch'

window.fetch(...)
```

## 3. Response timeout 제공

`Axios`에서는 시간 제한을 설정하는 것이 간단하다. `Fetch`를 통해 이를 구현은 할 수 있지만 보기 좋지가 않다.

## 4. HTTP interceptors

`Axios`의 핵심이라고 할 수 있는 기능 중 하나인 `interceptor`를 통해  HTTP 요청을 가로챌 수 있습니다. 이는 요청 전 header에 token을 보내야하는 경우에 일일이 api 하나씩 설정을 해주는게 아닌 `interceptor` 설정을 통해 한번에 처리가 가능합니다.

`Fetch`도 전역 `fetch()` 메서드를 덮어쓰고 자신만의 `interceptor`를 통해 정의할 수 있다. 하지만 개인적으로 설정 시 `Axios` 보다 직관성이 떨어지는 느낌이다.

## 5. 동시 요청

여러 요청을 수행하기 위해 `Axios`는 `axios.all()` 메서드를 제공한다. 이 메세드는 요청 배열을 전달한 이후 `axios.spread()`를 사용하여 응답 배열의 속성을 별도의 변수에 할당하면된다.

`Fetch`는 `Promise.all()` 메서드를 사용하여, response를 `async`으로 처리해 준다.

## 6. 에러 처리

`Axios`나 `Fetch`는 둘다 이행(resolve) 되거나 거부(reject)된 Promise를 반환한다. 거부 시 에러에 대한 처리를 해야하는데 `Axios`는 이에 매우 대응이 잘 되어 있다. `Axios`는 2xx 범위를 벗어나는 코드는 모두 에러 응답을 받았음을 나타냅니다. 이에 따라 에러 관련 처리를 하는데 용이합니다.

하지만 `Fetch`는 4xx를 받았다고 해서 거부되지 않습니다. 그러므로 당연스럽게 이행 부분에 이를 위한 로직 처리가 필요합니다.

## 7. 성능

속도적으로는 당연히 내부 라이브러리인 `Fetch`가 `Axios`보다 1.7배 정도 빠르다. 하지만 두 메서드 모두 비동기로 처리하기 때문에 크게 다가오지 않는 느낌이다.

## 개인적인 결론

개인적인 결론으로 `Axios`를 사용하는 이유는 협업에도 있는 느낌이다. `Fetch`를 사용한다면 `Axios`에서 있는 메서드들을 모두 만들 수는 있지만 각기 다른 로직을 가지고 만들 것이고 이는 또 하나의 업무가 쌓일 수도 있는 느낌이다. 간단한 프로젝트를 진행한다고 했을 때는 `Fetch`가 매우 유용할 수 있을 것 같고, 조금 큰 프로젝트를 진행한다고 했을 때 `Axios`를 사용하는게 조금 더 유용하다는 생각이다.
